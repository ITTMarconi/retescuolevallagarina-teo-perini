---
import type { Institute, Openday } from '../../../Data/types';
import { SERVER_ADDRESS, SERVER_PORT } from '../../../Data/constants.ts';
import OpenDay from './OpenDayListItem.astro';

interface Props {
  codice_MIUR: string;
}

const OPENDAYS_RAW = await fetch(`http://${SERVER_ADDRESS}:${SERVER_PORT}/opendays`);
const OPENDAYS: Openday[] = await OPENDAYS_RAW.json();
console.log(`Loaded ${OPENDAYS.length} opendays`);

const { codice_MIUR } = Astro.props;
---

<article>
  {OPENDAYS
  .filter(openday => openday.codice_MIUR === codice_MIUR)
  .map(openday => <OpenDay openday={openday} />)}
</article>

<style>
  article {
    width: 100%;

    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;

    gap: 1.2rem;
  }
</style>
